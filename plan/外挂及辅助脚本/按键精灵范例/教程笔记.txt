按键精灵使用的是Q语言

教程http://zy.anjian.com/index.php?action-viewnews-itemid-159
第一：完整脚本格式说明
        脚本分为几个部分，分别是
        [General] -- 通用的设置部分
        [Repeat]  -- 设置脚本循环的部分（目前没什么用处，只是为了兼容按键3.0）
        [Attachment]  -- 脚本附件，大家看到的是乱码，不要担心，其实和我们邮件附件的原理一模一样
        [Script]  --  脚本命令，所有脚本命令都在这里



导入：
    （1）【主界面】―【写脚本】―【工具栏】―【导入】
    （2）直接将Q文件“拖”到主界面的脚本目录，就会触发导入功能




录制：
  1、录制之后的脚本要在关键的位置加入一些延时。这样可以防止有些动作因为电脑性能的偏差不能准确的回放。
  2、一般来说录制动作不需要记录鼠标移动的轨迹，可以勾选掉这个选项再录制，可以减少脚本的命令条数。


关键词 dim定义 下划线间隔

常量声明 Const 常量名=值 
变量 xx = xx
用户自定义变量 Q语言特有 用于在不修改脚本的情况下用户可以设置 比如血量
                UserVar {变量}={默认值} {注释}

		下拉性变量UserVar 变量=DropList{选项0:值0|选项1:值1|选项2:值2}=默认显示的选项编号

日期 	CDate ("Aug 6, 1969")
    	CDate (1969, 8, 6)

数值转布尔 CBool
数值转字节（CByte）
转字符串 CStr 
MessageBox 弹窗提示值

And（逻辑与）、Or（逻辑或）、Not（逻辑非）、Xor（异或）
关键字按照系统标准自动变化。。也就是说你输入end,系统回自动变成End

选择：
if elseif else endif  可以加then

选色 IfColor 860,27,"e1b072",0 Then 
  分别是前两位的坐标参数 “860”,“27”，作为点坐标

  第三个参数是颜色值，这个可以使用抓抓工具获取。

  第四个参数是判断条件。值为0时就代表等于，为1时代表不等于，为2时代表约等于。


SELECT语句
 Select Case {变量}

  Case {值}

    {脚本内容}

  Case Else

    {脚本内容}

  End Select

循环FOR...Next
For 3
For i=1 To 3 Step 1

DO语句
Do While ...Loop

Do Until...Loop
While...Wend循环

子程序 SUB 相比函数FUCTION 不需要返回
Sub 子程序名(形参1...)

    End Sub

函数 Function 函数名(形参1...)

        //脚本代码 返回值用 函数名=xx返回

    End Function

数组Dim a(n) 这样会有0-n号元素，总共n+1个



###########################按键精灵命令#############
键盘命令 按键 按住 弹起  按键组合 按键次数


操作后台窗口 http://www.jb51.net/softjc/284239.html

按键精灵插件  比如图像插件 调用图像插件将屏幕截图保存成xx
    插件有两种使用方法
    1、用Plugin关键字带插件的命令，例如
    Plugin hWnd=Window.MousePoint()
    2、使用import命令导入插件，可省略Plugin关键字直接使用，例如
    import "window.dll"
    hWnd=Window.MousePoint()


命令库
让多个脚本共享一个命令，修改一处就等于修改多处。
  命令库的存放地址在按键精灵目录下的lib目录

多线程 多个脚本一起运行 不推荐新手使用
http://zy.anjian.com/index.php?action-viewnews-itemid-159


按键精灵脚本界面 简称 QUI  目前可以用ocx，但是需要学习其他语言，所以建议QUI
会在原有界面基础上多显示一些

QUI里面的内容可以被脚本读取
event注册事件
容器 存放控件 统一显示或隐藏
选项卡
定时器 时间间隔为0则不启动

网页按键精灵  在界面首页的右下角选择！

前台转后台

找色，通过找到颜色确定点击位置
找图需要把截图添加到附件里  取得的坐标是图片左上角
找字 需要截图 留边缘一个像素
命令插入


用工具把截图底色去掉，保留图标本色，相似度调高就行了
在挂机的时候和没挂机的时候图像有点区别

句柄 每个窗口打开的时候都会有系统编号 就是句柄  主句柄下可以有多个子句柄
如写字板界面 标题栏就是主句柄 内容就是子句柄 抓抓工具有句柄功能
所以一般操作就是获取句柄

用windows窗口插件制作

EndScript结束脚本执行
在IE中flash窗口才是单独句柄

防止被封：
间断式游戏
随机范围随机延迟

定时任务最好还是用按键精灵本身写

手机按键精灵有KeepCapture保存页面到内存

区域多点找色：抓抓的图像功能里，然后点击生成代码

so 抓图不如区域多点找色！！

TracePrint 打印信息 电脑版用TracePrint X&Y  手机版用 TracePrint X,Y   用&连接字符串

GetClientRect命令获取到的是窗口左上角坐标，和窗口的高度宽度。
寻找多个图就是先划分一下区域 或者从左到右刷一遍，再从上到下刷一遍。因为不可能水平和垂直方向都有重叠


抓一抓右键可以指定开始坐标 或者拖动鼠标拖出一个客户区坐标

图片四角的颜色相同时，则该颜色被视为透明色,找图命令忽略这种颜色
可以用色选(保留图片中选中的颜色)快速处理文字的杂色背景

放大镜不准确是因为你的电脑屏的像素与你设置定的实际像素不符合,所以有偏差。
将windows系统的显示字体改为原来大小

 
抓点抓下来的坐标可以在命令里直接用  ctrl+shift+0-9

截图可以大概估计一下自己要用的范围 截图之后可以右键抓点保存 和上面的一样

按print screen和按截图是一样的效果  区域找色

正常的图片100－－200之间为宜。所找图片色彩鲜明。查找图片时不能整屏查找，整屏查找会大大降低速度，屏幕上过多的色彩会影响到识别的准确度。
找图前给鼠标一个指令“MoveTo 0, 0”，把鼠标移开，如果找图的过程中鼠标在所找的区域同样会影响到准确度！
360等软件一定要关闭，这类的软件在一定程度上会阻止按键精灵的运行，好多时候并不是找图失败，而是按键精灵运行时被防护软件阻止了。

找图原理 从左到右 从上到下扫描 有时候找不到因为按钮半透明 颜色单一的时候需要相似度为1才行！

标记与跳转标记 可以用于循环
Rem te
Goto te

自动加血：用logo作为起点  然后用抓色
dim x 通常可以不写
数组 dim a(10)

SayString "test"  其他命令-输入文本


网页按键精灵：  点击网页分析，再f9启动，然后鼠标经过元素就有分析了

惯例：修改脚本名称和暂停的快捷键

鼠标特征码：用抓抓获取鼠标形状的特征码 再用鼠标命令中的得到鼠标形状判断

句柄 f8 抓取/结束抓取 可以指定父句柄抓取